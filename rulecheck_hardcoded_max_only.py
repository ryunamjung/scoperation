from __future__ import annotations

import io
import re
from datetime import datetime
from typing import Dict, List, Tuple

import pandas as pd
import streamlit as st

# ============================================================
# âœ… RULES: ì—‘ì…€(ê·œì¹™ê²°ê³¼_*.xlsx)ì—ì„œ ì¶”ì¶œí•´ "í•˜ë“œì½”ë”©"ëœ ë°ì´í„°
#    - ê° íŒŒì¼ë³„ case_n ìµœëŒ“ê°’ê³¼ ë™ì¼í•œ í–‰ë§Œ í¬í•¨
#    - case_n > 1 ì¡°ê±´ ì ìš©
# ============================================================
RULES: Dict[str, dict] = {'MZ001': {'base_col': 'ì²­êµ¬ì½”ë“œ', 'file_name': 'ê·œì¹™ê²°ê³¼_ì²­êµ¬ì½”ë“œ_MZ001_20251217_162619.xlsx', 'max_case_n': 9, 'rows': [{'í•­ëª©': '401', 'ì½”ë“œ': '644902691', 'ì²­êµ¬ì½”ë“œ': '644902691', 'ì²˜ë°©ì½”ë“œ': '64490269', 'ì½”ë“œëª…': '[331]ì¤‘ì™¸ìƒë¦¬ì‹ì—¼ì£¼ì‚¬ì•¡(20ml)', 'ë‹¨ê°€': '321', 'ê¸‰ë¹„': '0', 'case_n': 9, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '657804451', 'ì²­êµ¬ì½”ë“œ': '657804451', 'ì²˜ë°©ì½”ë“œ': '65780445', 'ì½”ë“œëª…': '[121]ë¡œì¹´í•€ì£¼7.5mg/ml(ë¡œí”¼ë°”ì¹´ì¸ì—¼ì‚°ì—¼ìˆ˜í™”ë¬¼)_(0.158g/20ml)', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '0', 'case_n': 9, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BM5100DC', 'ì²­êµ¬ì½”ë“œ': 'BM5100DC', 'ì²˜ë°©ì½”ë“œ': 'BM5100DCN', 'ì½”ë“œëª…': 'ì¸ì„±ë¶€ì§ë°˜ì°½ê³  ë‚˜ì˜', 'ë‹¨ê°€': '30,000', 'ê¸‰ë¹„': '3', 'case_n': 9, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'MZ001', 'ì²­êµ¬ì½”ë“œ': 'MZ001', 'ì²˜ë°©ì½”ë“œ': 'MZ001A', 'ì½”ë“œëª…': 'FIMS-(V)', 'ë‹¨ê°€': '600,000', 'ê¸‰ë¹„': '3', 'case_n': 9, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}]}, 'N0471': {'base_col': 'ì²­êµ¬ì½”ë“œ', 'file_name': 'ê·œì¹™ê²°ê³¼_ì²­êµ¬ì½”ë“œ_N0471_20251217_162438.xlsx', 'max_case_n': 5, 'rows': [{'í•­ëª©': '401', 'ì½”ë“œ': '644902691', 'ì²­êµ¬ì½”ë“œ': '644902691', 'ì²˜ë°©ì½”ë“œ': '64490269', 'ì½”ë“œëª…': '[331]ì¤‘ì™¸ìƒë¦¬ì‹ì—¼ì£¼ì‚¬ì•¡(20ml)', 'ë‹¨ê°€': '321', 'ê¸‰ë¹„': '0', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '(654802PE)', 'ì²­êµ¬ì½”ë“œ': '(654802PE)', 'ì²˜ë°©ì½”ë“œ': '654802PE', 'ì½”ë“œëª…': 'ì•¡ìƒí•˜ì´ë™ìŠ¤ì£¼ 750 I.U/0.5ml (PEN-ë¬´ìˆ˜ê°€)', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '0', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '(6706034A)', 'ì²­êµ¬ì½”ë“œ': '(6706034A)', 'ì²˜ë°©ì½”ë“œ': '6706034A', 'ì½”ë“œëª…': '[121]íœ´ì˜¨ìŠ¤ë¦¬ë„ì¹´ì¸1 %20ml(PEN-ë¬´ìˆ˜ê°€)', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '059600681', 'ì²­êµ¬ì½”ë“œ': '059600681', 'ì²˜ë°©ì½”ë“œ': '059600681', 'ì½”ë“œëª…': '[245]ë¦¬í¬íƒ€ì† ì£¼ 4mg/1ml(5)', 'ë‹¨ê°€': '50,000', 'ê¸‰ë¹„': '3', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '642200701', 'ì²­êµ¬ì½”ë“œ': '642200701', 'ì²˜ë°©ì½”ë“œ': 'BMIDAA', 'ì½”ë“œëª…': '[í–¥]*ë¶€ê´‘ë¯¸ë‹¤ì¡¸ëŒ 5mg/5ml (PEN-ë¬´ìˆ˜ê°€)', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '643700271', 'ì²­êµ¬ì½”ë“œ': '643700271', 'ì²˜ë°©ì½”ë“œ': '64370027', 'ì½”ë“œëª…': '[618]êµ­ì œì„¸íŒŒì œëˆì£¼1g(ì„¸íŒŒì œëˆë‚˜íŠ¸ë¥¨)', 'ë‹¨ê°€': '5,778', 'ê¸‰ë¹„': '0', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '648903331', 'ì²­êµ¬ì½”ë“œ': '648903331', 'ì²˜ë°©ì½”ë“œ': '6489033SC', 'ì½”ë“œëª…': '(ì²™ì¶”ì§„ì •)í”„ë¦¬ì„¸ë±ìŠ¤í”„ë¦¬ë¯¹ìŠ¤ì£¼ 20ml', 'ë‹¨ê°€': '100,000', 'ê¸‰ë¹„': '3', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '657802271', 'ì²­êµ¬ì½”ë“œ': '657802271', 'ì²˜ë°©ì½”ë“œ': '65780229', 'ì½”ë“œëª…': '[ë§ˆ]*í•˜ë‚˜êµ¬ì—°ì‚°íœíƒ€ë‹ 0.157mg/2ml (PEN-ë¬´ìˆ˜ê°€)', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '657804451', 'ì²­êµ¬ì½”ë“œ': '657804451', 'ì²˜ë°©ì½”ë“œ': '65780445N', 'ì½”ë“œëª…': '[121]PENìš© ë¡œì¹´í•€ì£¼7.5mg/ml_(0.158g/20ml)', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '657804561', 'ì²­êµ¬ì½”ë“œ': '657804561', 'ì²˜ë°©ì½”ë“œ': 'A0456B', 'ì½”ë“œëª…': '[111][í–¥]ì•„ë„¤í´ì£¼ì‚¬(í”„ë¡œí¬í´)_(50mg/5mL)(PEN-ë¬´ìˆ˜ê°€)', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': 'IX', 'ì²­êµ¬ì½”ë“œ': 'IX', 'ì²˜ë°©ì½”ë“œ': 'IX', 'ì½”ë“œëª…': 'ìˆ˜ê¸°ë£Œ ì‚°ì •ì•ˆí•¨', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '0', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': 'KK053', 'ì²­êµ¬ì½”ë“œ': 'KK053', 'ì²˜ë°©ì½”ë“œ': 'KK053', 'ì½”ë“œëª…': 'Fluid-501-1000mL', 'ë‹¨ê°€': '3,920', 'ê¸‰ë¹„': '0', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': 'KK054', 'ì²­êµ¬ì½”ë“œ': 'KK054', 'ì²˜ë°©ì½”ë“œ': 'KK054', 'ì½”ë“œëª…': 'IV side', 'ë‹¨ê°€': '1,440', 'ê¸‰ë¹„': '0', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': '699900020', 'ì²­êµ¬ì½”ë“œ': '699900020', 'ì²˜ë°©ì½”ë“œ': 'OXY02', 'ì½”ë“œëª…': 'ì²˜ì¹˜ìš©ì‚°ì†Œ 2L', 'ë‹¨ê°€': '11', 'ê¸‰ë¹„': '0', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BC1229RG', 'ì²­êµ¬ì½”ë“œ': 'BC1229RG', 'ì²˜ë°©ì½”ë“œ': 'BC1229RG', 'ì½”ë“œëª…': 'LSOë³´ì¡°ê¸°(ìš”ì¶”)', 'ë‹¨ê°€': '150,000', 'ê¸‰ë¹„': '3', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BJ4801UN', 'ì²­êµ¬ì½”ë“œ': 'BJ4801UN', 'ì²˜ë°©ì½”ë“œ': 'BJ4801UN', 'ì½”ë“œëª…': 'spinaut catheter(ìš”ì¶”) L-PEN', 'ë‹¨ê°€': '1,000,000', 'ê¸‰ë¹„': '3', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BK7000VB', 'ì²­êµ¬ì½”ë“œ': 'BK7000VB', 'ì²˜ë°©ì½”ë“œ': 'BK7000VB', 'ì½”ë“œëª…': 'BBAND (ì•„ì´ë¹„ë©”ë””ì¹¼)', 'ë‹¨ê°€': '30,000', 'ê¸‰ë¹„': '3', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BM5100DC', 'ì²­êµ¬ì½”ë“œ': 'BM5100DC', 'ì²˜ë°©ì½”ë“œ': 'BM5100DCN', 'ì½”ë“œëª…': 'ì¸ì„±ë¶€ì§ë°˜ì°½ê³  ë‚˜ì˜', 'ë‹¨ê°€': '30,000', 'ê¸‰ë¹„': '3', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'E5100070', 'ì²­êµ¬ì½”ë“œ': 'E5100070', 'ì²˜ë°©ì½”ë“œ': 'E5100051', 'ì½”ë“œëª…': 'Spinofill (ì•„ì´ë¹„ë©”ë””ì¹¼)', 'ë‹¨ê°€': '88,650', 'ê¸‰ë¹„': '0', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'F1401004', 'ì²­êµ¬ì½”ë“œ': 'F1401004', 'ì²˜ë°©ì½”ë“œ': 'F1401004', 'ì½”ë“œëª…': 'VP needle (ì•„ì´ë¹„ë©”ë””ì¹¼)', 'ë‹¨ê°€': '57,430', 'ê¸‰ë¹„': '0', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'M0040', 'ì²­êµ¬ì½”ë“œ': 'M0040', 'ì²˜ë°©ì½”ë“œ': 'M0040', 'ì½”ë“œëª…': 'O2 Inhalation(ì‚°ì†Œí¡ì…)-1ì¼ë‹¹', 'ë‹¨ê°€': '8,720', 'ê¸‰ë¹„': '0', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'M3101127', 'ì²­êµ¬ì½”ë“œ': 'M3101127', 'ì²˜ë°©ì½”ë“œ': 'M3101027', 'ì½”ë“œëª…': 'íì•¤íë©”ë”•ìŠ¤ë°´ë“œ ë¶€ì§í¬+íƒˆì§€ë©´íŒ¨ë“œ 6*8 [1í˜¸]', 'ë‹¨ê°€': '143', 'ê¸‰ë¹„': 'B', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'N0471', 'ì²­êµ¬ì½”ë“œ': 'N0471', 'ì²˜ë°©ì½”ë“œ': 'N0471', 'ì½”ë“œëª…': 'Vertebroplasty(VP)-1ë¶€ìœ„(ê²½í”¼ì  ì²™ì¶” ì„±í˜•ìˆ -1ë¶€ìœ„)', 'ë‹¨ê°€': '272,740', 'ê¸‰ë¹„': '0', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'SZ634', 'ì²­êµ¬ì½”ë“œ': 'SZ634', 'ì²˜ë°©ì½”ë“œ': 'SZ634A', 'ì½”ë“œëª…': 'PEN -Lumbar(ê²½í”¼ì  ê²½ë§‰ì™¸ê°• ì‹ ê²½ì„±í˜•ìˆ )', 'ë‹¨ê°€': '1,100,000', 'ê¸‰ë¹„': '3', 'case_n': 5, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}]}, 'N1494': {'base_col': 'ì²­êµ¬ì½”ë“œ', 'file_name': 'ê·œì¹™ê²°ê³¼_ì²­êµ¬ì½”ë“œ_N1494_20251217_162811.xlsx', 'max_case_n': 2, 'rows': [{'í•­ëª©': '401', 'ì½”ë“œ': '650500341', 'ì²­êµ¬ì½”ë“œ': '650500341', 'ì²˜ë°©ì½”ë“œ': '65050034', 'ì½”ë“œëª…': '[121]ì œì¼ë¦¬ë„ì¹´ì¸2%ì£¼(0.4g/20ml)', 'ë‹¨ê°€': '620', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '640001071', 'ì²­êµ¬ì½”ë“œ': '640001071', 'ì²˜ë°©ì½”ë“œ': '64000107', 'ì½”ë“œëª…': '[331]ì´ë…¸ì—”0.9%ìƒë¦¬ì‹ì—¼ì£¼ì‚¬ì•¡(100ml)', 'ë‹¨ê°€': '1,304', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '(PINJ05)', 'ì²­êµ¬ì½”ë“œ': '(PINJ05)', 'ì²˜ë°©ì½”ë“œ': 'PINJ05', 'ì½”ë“œëª…': 'í†µì¦ì£¼ì‚¬', 'ë‹¨ê°€': '50,000', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '640001711', 'ì²­êµ¬ì½”ë“œ': '640001711', 'ì²˜ë°©ì½”ë“œ': '64000171', 'ì½”ë“œëª…': '[339]ì´ë…¸ì—”ìƒë¦¬ì‹ì—¼ê´€ì£¼ì•¡(3000ml)', 'ë‹¨ê°€': '4,962', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '640002610', 'ì²­êµ¬ì½”ë“œ': '640002610', 'ì²˜ë°©ì½”ë“œ': '64000261', 'ì½”ë“œëª…': '[331]í”Œë¼ìŠ¤ë§ˆì†”ë£¨ì…˜ì—ì´ì£¼(1000ml)', 'ë‹¨ê°€': '4,815', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '640002680', 'ì²­êµ¬ì½”ë“œ': '640002680', 'ì²˜ë°©ì½”ë“œ': '64000268', 'ì½”ë“œëª…': '[331]ì´ë…¸ì—”í•˜íŠ¸ë§Œì•¡ 1000ml', 'ë‹¨ê°€': '1,675', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '641906121', 'ì²­êµ¬ì½”ë“œ': '641906121', 'ì²˜ë°©ì½”ë“œ': 'BNSR', 'ì½”ë“œëª…': '[235]ë‚˜ì œë¡ ì£¼ì‚¬ì•¡0.3mg(0.3mg/2ml)', 'ë‹¨ê°€': '18,475', 'ê¸‰ë¹„': '1', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '641907861', 'ì²­êµ¬ì½”ë“œ': '641907861', 'ì²˜ë°©ì½”ë“œ': '64190786', 'ì½”ë“œëª…': 'ë¸Œë ˆìŠ¤ì˜¨ì£¼ 2ml (ë³´ë ¹ì œì•½)', 'ë‹¨ê°€': '120,000', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '645100643', 'ì²­êµ¬ì½”ë“œ': '645100643', 'ì²˜ë°©ì½”ë“œ': 'AQU1', 'ì½”ë“œëª…': '[713]ëŒ€í•œë©¸ê· ì¦ë¥˜ìˆ˜20ml(ì•°í”Œ,PP)-ëŒ€í•œì•½í’ˆ*', 'ë‹¨ê°€': '211', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '648502361', 'ì²­êµ¬ì½”ë“œ': '648502361', 'ì²˜ë°©ì½”ë“œ': '64850236', 'ì½”ë“œëª…': '[332]*íŠ¸ë¼ë„¥ì‚¼ì‚°ì£¼ì‚¬500mg-ì‹ í’ì œì•½(ì£¼)', 'ë‹¨ê°€': '480', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '649800971', 'ì²­êµ¬ì½”ë“œ': '649800971', 'ì²˜ë°©ì½”ë“œ': 'BMBN', 'ì½”ë“œëª…': '[123]ëª…ë¬¸ëª¨ë¹„ëˆŒì£¼0.2mg/1ml(ê¸€ë¦¬ì½”í”¼ë¡¤ë ˆì´íŠ¸)', 'ë‹¨ê°€': '700', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '649804381', 'ì²­êµ¬ì½”ë“œ': '649804381', 'ì²˜ë°©ì½”ë“œ': '64980438', 'ì½”ë“œëª…': '[235]*ì˜¤íŠ¸ë¡ ì£¼(ì˜¨ë‹¨ì„¸íŠ¸ë¡ ì—¼ì‚°ì—¼ìˆ˜í™”ë¬¼)(ìˆ˜ì¶œëª…:ëª…ë¬¸ì˜¨ë‹¨ì„¸íŠ¸ë¡ ì£¼ì‚¬)_(5mg/2ml) ê¸‰ì—¬ëª…ë¬¸ì œì•½(ì£¼)', 'ë‹¨ê°€': '4,626', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '650500421', 'ì²­êµ¬ì½”ë“œ': '650500421', 'ì²˜ë°©ì½”ë“œ': 'A00421', 'ì½”ë“œëª…': '[245]*ì œì¼ì—í”¼ë„¤í”„ë¦°ì£¼ì‚¬ì•¡', 'ë‹¨ê°€': '338', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '652100211', 'ì²­êµ¬ì½”ë“œ': '652100211', 'ì²˜ë°©ì½”ë“œ': 'BLSX', 'ì½”ë“œëª…': '[213]*ë¼ì‹ìŠ¤ì£¼ì‚¬ 20mg (í•œë…)', 'ë‹¨ê°€': '349', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '653100701', 'ì²­êµ¬ì½”ë“œ': '653100701', 'ì²˜ë°©ì½”ë“œ': '65310070F', 'ì½”ë“œëª…': '[611](ORìš©-FREE)ë¹„ì”¨ë°˜ì½”ë§ˆì´ì‹ ì—¼ì‚°ì—¼ì£¼1g', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '653101191', 'ì²­êµ¬ì½”ë“œ': '653101191', 'ì²˜ë°©ì½”ë“œ': '653101191', 'ì½”ë“œëª…': '[222]ì•„ë¡ì†”ì£¼(ì•”ë¸Œë¡ì†”ì—¼ì‚°ì—¼)_(15mg/2mL)', 'ë‹¨ê°€': '300', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '653402351', 'ì²­êµ¬ì½”ë“œ': '653402351', 'ì²˜ë°©ì½”ë“œ': 'A0235', 'ì½”ë“œëª…': '[111][í–¥]í¬í´ì£¼ì‚¬12ml(í”„ë¡œí¬í´)', 'ë‹¨ê°€': '1,812', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '654802110', 'ì²­êµ¬ì½”ë“œ': '654802110', 'ì²˜ë°©ì½”ë“œ': '65480211', 'ì½”ë“œëª…': 'ì•¡ìƒí•˜ì´ë™ìŠ¤ì£¼ 750 I.U/0.5ml', 'ë‹¨ê°€': '40,000', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '655402961', 'ì²­êµ¬ì½”ë“œ': '655402961', 'ì²˜ë°©ì½”ë“œ': '65540296', 'ì½”ë“œëª…': '[122]ë¡œíë©”ë¡ ì£¼50mg/5ml(ë¡œì¿ ë¡œë‹ˆì›€ë¸Œë¡¬í™”ë¬¼)', 'ë‹¨ê°€': '3,174', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '657802273', 'ì²­êµ¬ì½”ë“œ': '657802273', 'ì²˜ë°©ì½”ë“œ': '65780227', 'ì½”ë“œëª…': '[821][ë§ˆ]í•˜ë‚˜êµ¬ì—°ì‚°íœíƒ€ë‹ì£¼0.157mg/2ml', 'ë‹¨ê°€': '2,071', 'ê¸‰ë¹„': '1', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '657802283', 'ì²­êµ¬ì½”ë“œ': '657802283', 'ì²˜ë°©ì½”ë“œ': '65780228', 'ì½”ë“œëª…': '[821][ë§ˆ]í•˜ë‚˜êµ¬ì—°ì‚°íœíƒ€ë‹ì£¼ì‚¬(10ml/ì•°í”Œ(P)', 'ë‹¨ê°€': '9,954', 'ê¸‰ë¹„': '1', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '657804451', 'ì²­êµ¬ì½”ë“œ': '657804451', 'ì²˜ë°©ì½”ë“œ': '65780445', 'ì½”ë“œëª…': '[121]ë¡œì¹´í•€ì£¼7.5mg/ml(ë¡œí”¼ë°”ì¹´ì¸ì—¼ì‚°ì—¼ìˆ˜í™”ë¬¼)_(0.158g/20ml)', 'ë‹¨ê°€': '5,338', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '662800061', 'ì²­êµ¬ì½”ë“œ': '662800061', 'ì²˜ë°©ì½”ë“œ': 'NDNAPL', 'ì½”ë“œëª…': 'ì‹ ê²½ì†ìƒDNA-í”Œë¼ì„¼í…ìŠ¤ì£¼', 'ë‹¨ê°€': '120,000', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '670602631', 'ì²­êµ¬ì½”ë“œ': '670602631', 'ì²˜ë°©ì½”ë“œ': '67060263', 'ì½”ë“œëª…': 'í•˜ì´ì½”ë¯¼ì£¼ì‚¬ 2ml(fee free-í•˜ë¶€ì½”ë“œì „ìš©)', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '670603464', 'ì²­êµ¬ì½”ë“œ': '670603464', 'ì²˜ë°©ì½”ë“œ': '67060346', 'ì½”ë“œëª…': '[121]íœ´ì˜¨ìŠ¤ë¦¬ë„ì¹´ì¸1%ì£¼(0.2134g/20ml)', 'ë‹¨ê°€': '641', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '681100401', 'ì²­êµ¬ì½”ë“œ': '681100401', 'ì²˜ë°©ì½”ë“œ': '6932AAP', 'ì½”ë“œëª…': '(fee free-í•˜ë¶€ì½”ë“œì „ìš©)GCWì•„ì„¸íŠ¸ì•„ë¯¸ë…¸íœì£¼', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': 'IX', 'ì²­êµ¬ì½”ë“œ': 'IX', 'ì²˜ë°©ì½”ë“œ': 'IX', 'ì½”ë“œëª…': 'ìˆ˜ê¸°ë£Œ ì‚°ì •ì•ˆí•¨', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': 'KK052', 'ì²­êµ¬ì½”ë“œ': 'KK052', 'ì²˜ë°©ì½”ë“œ': 'KK052', 'ì½”ë“œëª…': 'Fluid-100-500mL', 'ë‹¨ê°€': '3,220', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': 'KK053', 'ì²­êµ¬ì½”ë“œ': 'KK053', 'ì²˜ë°©ì½”ë“œ': 'KK053', 'ì½”ë“œëª…': 'Fluid-501-1000mL', 'ë‹¨ê°€': '3,920', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': 'KK054', 'ì²­êµ¬ì½”ë“œ': 'KK054', 'ì²˜ë°©ì½”ë“œ': 'KK054', 'ì½”ë“œëª…': 'IV side', 'ë‹¨ê°€': '1,440', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BJ4802UN', 'ì²­êµ¬ì½”ë“œ': 'BJ4802UN', 'ì²˜ë°©ì½”ë“œ': 'BJ4802UN', 'ì½”ë“œëª…': 'Spinaut-V Epidural Catheter(ì•„ì´ë¹„ë©”ë””ì¹¼)', 'ë‹¨ê°€': '2,000,000', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BK7000VB', 'ì²­êµ¬ì½”ë“œ': 'BK7000VB', 'ì²˜ë°©ì½”ë“œ': 'BK7000VB', 'ì½”ë“œëª…': 'BBAND (ì•„ì´ë¹„ë©”ë””ì¹¼)', 'ë‹¨ê°€': '30,000', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BK7000ZC', 'ì²­êµ¬ì½”ë“œ': 'BK7000ZC', 'ì²˜ë°©ì½”ë“œ': 'BK7000ZC', 'ì½”ë“œëª…': 'MEDIAS T (ì•„ì´ë¹„ë©”ë””ì¹¼)', 'ë‹¨ê°€': '12,000', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BM2000JI', 'ì²­êµ¬ì½”ë“œ': 'BM2000JI', 'ì²˜ë°©ì½”ë“œ': 'BM2000JI', 'ì½”ë“œëª…': 'Tape silicone(innomed) 2.5*30cm (ë¹„ì¦ˆë©”ë””)', 'ë‹¨ê°€': '4,950', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BM5100DC', 'ì²­êµ¬ì½”ë“œ': 'BM5100DC', 'ì²˜ë°©ì½”ë“œ': 'BM5100DCM', 'ì½”ë“œëª…': 'ì¸ì„±ë¶€ì§ë°˜ì°½ê³  ë§ˆìŠ¤í¬', 'ë‹¨ê°€': '30,000', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BM5100JN', 'ì²­êµ¬ì½”ë“œ': 'BM5100JN', 'ì²˜ë°©ì½”ë“œ': 'BM5101JN', 'ì½”ë“œëª…': 'VS ë°´ë“œ (ì•„ì´ë¹„ë©”ë””ì¹¼)', 'ë‹¨ê°€': '30,000', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'J4306735', 'ì²­êµ¬ì½”ë“œ': 'J4306735', 'ì²˜ë°©ì½”ë“œ': 'J4306735', 'ì½”ë“œëª…': 'Autofuser K Bolus (PCA )(ì•„ì´ë¹„ë©”ë””ì¹¼)', 'ë‹¨ê°€': '54,150', 'ê¸‰ë¹„': 'B', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'K3002304', 'ì²­êµ¬ì½”ë“œ': 'K3002304', 'ì²˜ë°©ì½”ë“œ': 'K3002304', 'ì½”ë“œëª…': 'Barovac-Pp (ì„¸ìš´)', 'ë‹¨ê°€': '17,160', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'K3100105', 'ì²­êµ¬ì½”ë“œ': 'K3100105', 'ì²˜ë°©ì½”ë“œ': 'K3100005', 'ì½”ë“œëª…': 'Urine Bag (ë¹„ì¦ˆë©”ë””)', 'ë‹¨ê°€': '1,290', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'K4041031', 'ì²­êµ¬ì½”ë“œ': 'K4041031', 'ì²˜ë°©ì½”ë“œ': 'K4041031', 'ì½”ë“œëª…': 'E-Tube Reinforced Cuffed Type(êº½ì„ë°©ì§€í˜•)(ì „ê·œê²©)(ë¹„ì¦ˆë©”ë””)', 'ë‹¨ê°€': '14,820', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'K4430035', 'ì²­êµ¬ì½”ë“œ': 'K4430035', 'ì²˜ë°©ì½”ë“œ': 'K4430035', 'ì½”ë“œëª…': 'ACE BLADE(ë¹„ì „ë©”ë””)', 'ë‹¨ê°€': '15,750', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'K4501361', 'ì²­êµ¬ì½”ë“œ': 'K4501361', 'ì²˜ë°©ì½”ë“œ': 'K4501361', 'ì½”ë“œëª…': 'HEATED CIRCUIT', 'ë‹¨ê°€': '57,070', 'ê¸‰ë¹„': 'B', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'K5001504', 'ì²­êµ¬ì½”ë“œ': 'K5001504', 'ì²˜ë°©ì½”ë“œ': 'K5001003', 'ì½”ë“œëª…': 'Foley Cath(14fr/16Fr/18 Fr)(ë¹„ì¦ˆë©”ë””)', 'ë‹¨ê°€': '3,790', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'K9205250', 'ì²­êµ¬ì½”ë“œ': 'K9205250', 'ì²˜ë°©ì½”ë“œ': 'K9205250', 'ì½”ë“œëª…': 'M-Clot [ì „ê·œê²©]', 'ë‹¨ê°€': '100,000', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'L9002003', 'ì²­êµ¬ì½”ë“œ': 'L9002003', 'ì²˜ë°©ì½”ë“œ': 'L9002003', 'ì½”ë“œëª…': 'Bis Xp Platform Polyester ë“± (ì „ì‹ ë§ˆì·¨ì‹œ)(íë©”ë”•ìŠ¤)', 'ë‹¨ê°€': '43,730', 'ê¸‰ë¹„': 'B', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'M0060', 'ì²­êµ¬ì½”ë“œ': 'M0060', 'ì²˜ë°©ì½”ë“œ': 'M0060', 'ì½”ë“œëª…': 'Foley Catheterization', 'ë‹¨ê°€': '12,380', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'M6610161', 'ì²­êµ¬ì½”ë“œ': 'M6610161', 'ì²˜ë°©ì½”ë“œ': 'M6610161', 'ì½”ë“œëª…': 'ACE GRIP ENDO FIXâ…¡', 'ë‹¨ê°€': '7,580', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'M6710639', 'ì²­êµ¬ì½”ë“œ': 'M6710639', 'ì²˜ë°©ì½”ë“œ': 'M6710639', 'ì½”ë“œëª…': 'Multifix EF(í´ë¦¬ìš©)(ìœ ì¹˜ì¹´í…Œí„° ê³ ì •ìš©)(ë¹„ì¦ˆë©”ë””)', 'ë‹¨ê°€': '1,500', 'ê¸‰ë¹„': 'B', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'N0031004', 'ì²­êµ¬ì½”ë“œ': 'N0031004', 'ì²˜ë°©ì½”ë“œ': 'N0031004', 'ì½”ë“œëª…': 'ë‚´ì‹œê²½í•˜ ì¶”ê°„íŒì œê±°ìˆ ì‹œ ì‚¬ìš©í•˜ëŠ” ì¹˜ë£Œì¬ë£Œ ë¹„ìš©', 'ë‹¨ê°€': '160,000', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'N0101512', 'ì²­êµ¬ì½”ë“œ': 'N0101512', 'ì²˜ë°©ì½”ë“œ': 'N0101512', 'ì½”ë“œëª…': 'ìˆ˜ìˆ íŒ©(â…¡)(ë§ˆì·¨ì‹œê°„ 1ì‹œê°„ì´ˆê³¼~3ì‹œê°„ì´í•˜)', 'ë‹¨ê°€': '45,390', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'N1494', 'ì²­êµ¬ì½”ë“œ': 'N1494', 'ì²˜ë°©ì½”ë“œ': 'N1494', 'ì½”ë“œëª…': 'Diskectomy-by endoscopy(ì¶”ê°„íŒì œê±°ìˆ -ë‚´ì‹œê²½í•˜)', 'ë‹¨ê°€': '523,080', 'ê¸‰ë¹„': '0', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'SZ631', 'ì²­êµ¬ì½”ë“œ': 'SZ631', 'ì²˜ë°©ì½”ë“œ': 'SZ6313', 'ì½”ë“œëª…': 'EED (ë‚´ì‹œê²½ì  ê²½ë§‰ì™¸ê°• ì‹ ê²½ê°ì••ìˆ )', 'ë‹¨ê°€': '3,000,000', 'ê¸‰ë¹„': '3', 'case_n': 2, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}]}, 'N1499': {'base_col': 'ì²­êµ¬ì½”ë“œ', 'file_name': 'ê·œì¹™ê²°ê³¼_ì²­êµ¬ì½”ë“œ_N1499_20251217_162305.xlsx', 'max_case_n': 16, 'rows': [{'í•­ëª©': '401', 'ì½”ë“œ': '644902691', 'ì²­êµ¬ì½”ë“œ': '644902691', 'ì²˜ë°©ì½”ë“œ': '64490269', 'ì½”ë“œëª…': '[331]ì¤‘ì™¸ìƒë¦¬ì‹ì—¼ì£¼ì‚¬ì•¡(20ml)', 'ë‹¨ê°€': '321', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '657802273', 'ì²­êµ¬ì½”ë“œ': '657802273', 'ì²˜ë°©ì½”ë“œ': '65780227', 'ì½”ë“œëª…': '[821][ë§ˆ]í•˜ë‚˜êµ¬ì—°ì‚°íœíƒ€ë‹ì£¼0.157mg/2ml', 'ë‹¨ê°€': '2,071', 'ê¸‰ë¹„': '1', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '640001071', 'ì²­êµ¬ì½”ë“œ': '640001071', 'ì²˜ë°©ì½”ë“œ': '64000107', 'ì½”ë“œëª…': '[331]ì´ë…¸ì—”0.9%ìƒë¦¬ì‹ì—¼ì£¼ì‚¬ì•¡(100ml)', 'ë‹¨ê°€': '1,304', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '641906121', 'ì²­êµ¬ì½”ë“œ': '641906121', 'ì²˜ë°©ì½”ë“œ': 'BNSR', 'ì½”ë“œëª…': '[235]ë‚˜ì œë¡ ì£¼ì‚¬ì•¡0.3mg(0.3mg/2ml)', 'ë‹¨ê°€': '18,475', 'ê¸‰ë¹„': '1', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '641907861', 'ì²­êµ¬ì½”ë“œ': '641907861', 'ì²˜ë°©ì½”ë“œ': '64190786', 'ì½”ë“œëª…': 'ë¸Œë ˆìŠ¤ì˜¨ì£¼ 2ml (ë³´ë ¹ì œì•½)', 'ë‹¨ê°€': '120,000', 'ê¸‰ë¹„': '3', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '645100341', 'ì²­êµ¬ì½”ë“œ': '645100341', 'ì²˜ë°©ì½”ë“œ': 'A0341', 'ì½”ë“œëª…': '[349](ORìš©)ëŒ€í•œê´€ë¥˜ìš©ë©¸ê· ìƒë¦¬ì‹ì—¼ìˆ˜_(9g/1000mL)', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '645100643', 'ì²­êµ¬ì½”ë“œ': '645100643', 'ì²˜ë°©ì½”ë“œ': 'AQU1', 'ì½”ë“œëª…': '[713]ëŒ€í•œë©¸ê· ì¦ë¥˜ìˆ˜20ml(ì•°í”Œ,PP)-ëŒ€í•œì•½í’ˆ*', 'ë‹¨ê°€': '211', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '649800971', 'ì²­êµ¬ì½”ë“œ': '649800971', 'ì²˜ë°©ì½”ë“œ': 'BMBN', 'ì½”ë“œëª…': '[123]ëª…ë¬¸ëª¨ë¹„ëˆŒì£¼0.2mg/1ml(ê¸€ë¦¬ì½”í”¼ë¡¤ë ˆì´íŠ¸)', 'ë‹¨ê°€': '700', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '649804381', 'ì²­êµ¬ì½”ë“œ': '649804381', 'ì²˜ë°©ì½”ë“œ': '64980438', 'ì½”ë“œëª…': '[235]*ì˜¤íŠ¸ë¡ ì£¼(ì˜¨ë‹¨ì„¸íŠ¸ë¡ ì—¼ì‚°ì—¼ìˆ˜í™”ë¬¼)(ìˆ˜ì¶œëª…:ëª…ë¬¸ì˜¨ë‹¨ì„¸íŠ¸ë¡ ì£¼ì‚¬)_(5mg/2ml) ê¸‰ì—¬ëª…ë¬¸ì œì•½(ì£¼)', 'ë‹¨ê°€': '4,626', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '650500421', 'ì²­êµ¬ì½”ë“œ': '650500421', 'ì²˜ë°©ì½”ë“œ': 'A00421', 'ì½”ë“œëª…': '[245]*ì œì¼ì—í”¼ë„¤í”„ë¦°ì£¼ì‚¬ì•¡', 'ë‹¨ê°€': '338', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '653100701', 'ì²­êµ¬ì½”ë“œ': '653100701', 'ì²˜ë°©ì½”ë“œ': '65310070F', 'ì½”ë“œëª…': '[611](ORìš©-FREE)ë¹„ì”¨ë°˜ì½”ë§ˆì´ì‹ ì—¼ì‚°ì—¼ì£¼1g', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '653101191', 'ì²­êµ¬ì½”ë“œ': '653101191', 'ì²˜ë°©ì½”ë“œ': '653101191', 'ì½”ë“œëª…': '[222]ì•„ë¡ì†”ì£¼(ì•”ë¸Œë¡ì†”ì—¼ì‚°ì—¼)_(15mg/2mL)', 'ë‹¨ê°€': '300', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '653402351', 'ì²­êµ¬ì½”ë“œ': '653402351', 'ì²˜ë°©ì½”ë“œ': 'A0235', 'ì½”ë“œëª…': '[111][í–¥]í¬í´ì£¼ì‚¬12ml(í”„ë¡œí¬í´)', 'ë‹¨ê°€': '1,812', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '655402961', 'ì²­êµ¬ì½”ë“œ': '655402961', 'ì²˜ë°©ì½”ë“œ': '65540296', 'ì½”ë“œëª…': '[122]ë¡œíë©”ë¡ ì£¼50mg/5ml(ë¡œì¿ ë¡œë‹ˆì›€ë¸Œë¡¬í™”ë¬¼)', 'ë‹¨ê°€': '3,174', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '657802283', 'ì²­êµ¬ì½”ë“œ': '657802283', 'ì²˜ë°©ì½”ë“œ': '65780228', 'ì½”ë“œëª…': '[821][ë§ˆ]í•˜ë‚˜êµ¬ì—°ì‚°íœíƒ€ë‹ì£¼ì‚¬(10ml/ì•°í”Œ(P)', 'ë‹¨ê°€': '9,954', 'ê¸‰ë¹„': '1', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '657804451', 'ì²­êµ¬ì½”ë“œ': '657804451', 'ì²˜ë°©ì½”ë“œ': '65780445', 'ì½”ë“œëª…': '[121]ë¡œì¹´í•€ì£¼7.5mg/ml(ë¡œí”¼ë°”ì¹´ì¸ì—¼ì‚°ì—¼ìˆ˜í™”ë¬¼)_(0.158g/20ml)', 'ë‹¨ê°€': '5,338', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': 'IX', 'ì²­êµ¬ì½”ë“œ': 'IX', 'ì²˜ë°©ì½”ë“œ': 'IX', 'ì½”ë“œëª…': 'ìˆ˜ê¸°ë£Œ ì‚°ì •ì•ˆí•¨', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': 'KK053', 'ì²­êµ¬ì½”ë“œ': 'KK053', 'ì²˜ë°©ì½”ë“œ': 'KK053', 'ì½”ë“œëª…': 'Fluid-501-1000mL', 'ë‹¨ê°€': '3,920', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'B0003006', 'ì²­êµ¬ì½”ë“œ': 'B0003006', 'ì²˜ë°©ì½”ë“œ': 'B0003006', 'ì½”ë“œëª…': 'Nylon 3/0 (ë¹„ì¦ˆë©”ë””)', 'ë‹¨ê°€': '1,460', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BK7000ZC', 'ì²­êµ¬ì½”ë“œ': 'BK7000ZC', 'ì²˜ë°©ì½”ë“œ': 'BK7000ZC', 'ì½”ë“œëª…': 'MEDIAS T (ì•„ì´ë¹„ë©”ë””ì¹¼)', 'ë‹¨ê°€': '12,000', 'ê¸‰ë¹„': '3', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BM2000JI', 'ì²­êµ¬ì½”ë“œ': 'BM2000JI', 'ì²˜ë°©ì½”ë“œ': 'BM2000JI', 'ì½”ë“œëª…': 'Tape silicone(innomed) 2.5*30cm (ë¹„ì¦ˆë©”ë””)', 'ë‹¨ê°€': '4,950', 'ê¸‰ë¹„': '3', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BM5100DC', 'ì²­êµ¬ì½”ë“œ': 'BM5100DC', 'ì²˜ë°©ì½”ë“œ': 'BM5100DCM', 'ì½”ë“œëª…': 'ì¸ì„±ë¶€ì§ë°˜ì°½ê³  ë§ˆìŠ¤í¬', 'ë‹¨ê°€': '30,000', 'ê¸‰ë¹„': '3', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BM5100JN', 'ì²­êµ¬ì½”ë“œ': 'BM5100JN', 'ì²˜ë°©ì½”ë“œ': 'BM5101JN', 'ì½”ë“œëª…': 'VS ë°´ë“œ (ì•„ì´ë¹„ë©”ë””ì¹¼)', 'ë‹¨ê°€': '30,000', 'ê¸‰ë¹„': '3', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BM5100RW', 'ì²­êµ¬ì½”ë“œ': 'BM5100RW', 'ì²˜ë°©ì½”ë“œ': 'BM5100RW', 'ì½”ë“œëª…': 'ë©”ë””íì–´ë¡¤ë°˜ì°½ê³ 4 ì¸ì¹˜(10*10) (ë¹„ì¦ˆë©”ë””)', 'ë‹¨ê°€': '1,000', 'ê¸‰ë¹„': '3', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'J4306735', 'ì²­êµ¬ì½”ë“œ': 'J4306735', 'ì²˜ë°©ì½”ë“œ': 'J4306735', 'ì½”ë“œëª…': 'Autofuser K Bolus (PCA )(ì•„ì´ë¹„ë©”ë””ì¹¼)', 'ë‹¨ê°€': '54,150', 'ê¸‰ë¹„': 'B', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'K3002304', 'ì²­êµ¬ì½”ë“œ': 'K3002304', 'ì²˜ë°©ì½”ë“œ': 'K3002304', 'ì½”ë“œëª…': 'Barovac-Pp (ì„¸ìš´)', 'ë‹¨ê°€': '17,160', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'K4041031', 'ì²­êµ¬ì½”ë“œ': 'K4041031', 'ì²˜ë°©ì½”ë“œ': 'K4041031', 'ì½”ë“œëª…': 'E-Tube Reinforced Cuffed Type(êº½ì„ë°©ì§€í˜•)(ì „ê·œê²©)(ë¹„ì¦ˆë©”ë””)', 'ë‹¨ê°€': '14,820', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'K4430035', 'ì²­êµ¬ì½”ë“œ': 'K4430035', 'ì²˜ë°©ì½”ë“œ': 'K4430035', 'ì½”ë“œëª…': 'ACE BLADE(ë¹„ì „ë©”ë””)', 'ë‹¨ê°€': '15,750', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'K4501361', 'ì²­êµ¬ì½”ë“œ': 'K4501361', 'ì²˜ë°©ì½”ë“œ': 'K4501361', 'ì½”ë“œëª…': 'HEATED CIRCUIT', 'ë‹¨ê°€': '57,070', 'ê¸‰ë¹„': 'B', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'K9205050', 'ì²­êµ¬ì½”ë“œ': 'K9205050', 'ì²˜ë°©ì½”ë“œ': 'K9205050', 'ì½”ë“œëª…': 'WOUNDCLOT ABC', 'ë‹¨ê°€': '300,000', 'ê¸‰ë¹„': '3', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'K9205250', 'ì²­êµ¬ì½”ë“œ': 'K9205250', 'ì²˜ë°©ì½”ë“œ': 'K9205250', 'ì½”ë“œëª…': 'M-Clot [ì „ê·œê²©]', 'ë‹¨ê°€': '100,000', 'ê¸‰ë¹„': '3', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'M6610161', 'ì²­êµ¬ì½”ë“œ': 'M6610161', 'ì²˜ë°©ì½”ë“œ': 'M6610161', 'ì½”ë“œëª…': 'ACE GRIP ENDO FIXâ…¡', 'ë‹¨ê°€': '7,580', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'M6710639', 'ì²­êµ¬ì½”ë“œ': 'M6710639', 'ì²˜ë°©ì½”ë“œ': 'M6710639', 'ì½”ë“œëª…': 'Multifix EF(í´ë¦¬ìš©)(ìœ ì¹˜ì¹´í…Œí„° ê³ ì •ìš©)(ë¹„ì¦ˆë©”ë””)', 'ë‹¨ê°€': '1,500', 'ê¸‰ë¹„': 'B', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'N0051006', 'ì²­êµ¬ì½”ë“œ': 'N0051006', 'ì²˜ë°©ì½”ë“œ': 'N0051006', 'ì½”ë“œëª…': 'ì²™ì¶” ë° ì²™ìˆ˜ìˆ˜ìˆ ì— ì‚¬ìš©í•œ Burr,Saw ë“± ì ˆì‚­ê¸°ë¥˜', 'ë‹¨ê°€': '116,250', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'N1499', 'ì²­êµ¬ì½”ë“œ': 'N1499', 'ì²˜ë°©ì½”ë“œ': 'N1499', 'ì½”ë“œëª…': 'Laminectomy-lumbar(ì²™ì¶”í›„ê¶ì ˆì œìˆ -ìš”ì¶”)', 'ë‹¨ê°€': '615,160', 'ê¸‰ë¹„': '0', 'case_n': 16, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}]}, 'SZ631': {'base_col': 'ì²­êµ¬ì½”ë“œ', 'file_name': 'ê·œì¹™ê²°ê³¼_ì²­êµ¬ì½”ë“œ_SZ631_20251217_162151.xlsx', 'max_case_n': 14, 'rows': [{'í•­ëª©': '401', 'ì½”ë“œ': '657804451', 'ì²­êµ¬ì½”ë“œ': '657804451', 'ì²˜ë°©ì½”ë“œ': '65780445', 'ì½”ë“œëª…': '[121]ë¡œì¹´í•€ì£¼7.5mg/ml(ë¡œí”¼ë°”ì¹´ì¸ì—¼ì‚°ì—¼ìˆ˜í™”ë¬¼)_(0.158g/20ml)', 'ë‹¨ê°€': '5,338', 'ê¸‰ë¹„': '0', 'case_n': 14, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '(PINJ05)', 'ì²­êµ¬ì½”ë“œ': '(PINJ05)', 'ì²˜ë°©ì½”ë“œ': 'PINJ05', 'ì½”ë“œëª…': 'í†µì¦ì£¼ì‚¬', 'ë‹¨ê°€': '50,000', 'ê¸‰ë¹„': '3', 'case_n': 14, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '670602631', 'ì²­êµ¬ì½”ë“œ': '670602631', 'ì²˜ë°©ì½”ë“œ': '67060263', 'ì½”ë“œëª…': 'í•˜ì´ì½”ë¯¼ì£¼ì‚¬ 2ml(fee free-í•˜ë¶€ì½”ë“œì „ìš©)', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 14, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '681100401', 'ì²­êµ¬ì½”ë“œ': '681100401', 'ì²˜ë°©ì½”ë“œ': '6932AAP', 'ì½”ë“œëª…': '(fee free-í•˜ë¶€ì½”ë“œì „ìš©)GCWì•„ì„¸íŠ¸ì•„ë¯¸ë…¸íœì£¼', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 14, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': 'IX', 'ì²­êµ¬ì½”ë“œ': 'IX', 'ì²˜ë°©ì½”ë“œ': 'IX', 'ì½”ë“œëª…': 'ìˆ˜ê¸°ë£Œ ì‚°ì •ì•ˆí•¨', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '0', 'case_n': 14, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': 'KK053', 'ì²­êµ¬ì½”ë“œ': 'KK053', 'ì²˜ë°©ì½”ë“œ': 'KK053', 'ì½”ë“œëª…': 'Fluid-501-1000mL', 'ë‹¨ê°€': '3,920', 'ê¸‰ë¹„': '0', 'case_n': 14, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': 'KK054', 'ì²­êµ¬ì½”ë“œ': 'KK054', 'ì²˜ë°©ì½”ë“œ': 'KK054', 'ì½”ë“œëª…': 'IV side', 'ë‹¨ê°€': '1,440', 'ê¸‰ë¹„': '0', 'case_n': 14, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BM5100DC', 'ì²­êµ¬ì½”ë“œ': 'BM5100DC', 'ì²˜ë°©ì½”ë“œ': 'BM5100DCN', 'ì½”ë“œëª…': 'ì¸ì„±ë¶€ì§ë°˜ì°½ê³  ë‚˜ì˜', 'ë‹¨ê°€': '30,000', 'ê¸‰ë¹„': '3', 'case_n': 14, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BJ4802UN', 'ì²­êµ¬ì½”ë“œ': 'BJ4802UN', 'ì²˜ë°©ì½”ë“œ': 'BJ4802UNF', 'ì½”ë“œëª…': '(EED)Spinaut-V Epidural Catheter-ë¬´ìˆ˜ê°€', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 14, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BK7000VB', 'ì²­êµ¬ì½”ë“œ': 'BK7000VB', 'ì²˜ë°©ì½”ë“œ': 'BK7000VB', 'ì½”ë“œëª…': 'BBAND (ì•„ì´ë¹„ë©”ë””ì¹¼)', 'ë‹¨ê°€': '30,000', 'ê¸‰ë¹„': '3', 'case_n': 14, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'SZ631', 'ì²­êµ¬ì½”ë“œ': 'SZ631', 'ì²˜ë°©ì½”ë“œ': 'SZ6313', 'ì½”ë“œëª…': 'EED (ë‚´ì‹œê²½ì  ê²½ë§‰ì™¸ê°• ì‹ ê²½ê°ì••ìˆ )', 'ë‹¨ê°€': '3,000,000', 'ê¸‰ë¹„': '3', 'case_n': 14, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}]}, 'SZ634': {'base_col': 'ì²­êµ¬ì½”ë“œ', 'file_name': 'ê·œì¹™ê²°ê³¼_ì²­êµ¬ì½”ë“œ_SZ634_20251217_155111.xlsx', 'max_case_n': 19, 'rows': [{'í•­ëª©': '401', 'ì½”ë“œ': '644902691', 'ì²­êµ¬ì½”ë“œ': '644902691', 'ì²˜ë°©ì½”ë“œ': '64490269', 'ì½”ë“œëª…': '[331]ì¤‘ì™¸ìƒë¦¬ì‹ì—¼ì£¼ì‚¬ì•¡(20ml)', 'ë‹¨ê°€': '321', 'ê¸‰ë¹„': '0', 'case_n': 19, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '(6706034A)', 'ì²­êµ¬ì½”ë“œ': '(6706034A)', 'ì²˜ë°©ì½”ë“œ': '6706034A', 'ì½”ë“œëª…': '[121]íœ´ì˜¨ìŠ¤ë¦¬ë„ì¹´ì¸1 %20ml(PEN-ë¬´ìˆ˜ê°€)', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 19, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '401', 'ì½”ë“œ': '657802271', 'ì²­êµ¬ì½”ë“œ': '657802271', 'ì²˜ë°©ì½”ë“œ': '65780229', 'ì½”ë“œëª…': '[ë§ˆ]*í•˜ë‚˜êµ¬ì—°ì‚°íœíƒ€ë‹ 0.157mg/2ml (PEN-ë¬´ìˆ˜ê°€)', 'ë‹¨ê°€': '0', 'ê¸‰ë¹„': '3', 'case_n': 19, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': '699900020', 'ì²­êµ¬ì½”ë“œ': '699900020', 'ì²˜ë°©ì½”ë“œ': 'OXY02', 'ì½”ë“œëª…': 'ì²˜ì¹˜ìš©ì‚°ì†Œ 2L', 'ë‹¨ê°€': '11', 'ê¸‰ë¹„': '0', 'case_n': 19, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'BM5100DC', 'ì²­êµ¬ì½”ë“œ': 'BM5100DC', 'ì²˜ë°©ì½”ë“œ': 'BM5100DCN', 'ì½”ë“œëª…': 'ì¸ì„±ë¶€ì§ë°˜ì°½ê³  ë‚˜ì˜', 'ë‹¨ê°€': '30,000', 'ê¸‰ë¹„': '3', 'case_n': 19, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'M0040', 'ì²­êµ¬ì½”ë“œ': 'M0040', 'ì²˜ë°©ì½”ë“œ': 'M0040', 'ì½”ë“œëª…': 'O2 Inhalation(ì‚°ì†Œí¡ì…)-1ì¼ë‹¹', 'ë‹¨ê°€': '8,720', 'ê¸‰ë¹„': '0', 'case_n': 19, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'M3101127', 'ì²­êµ¬ì½”ë“œ': 'M3101127', 'ì²˜ë°©ì½”ë“œ': 'M3101027', 'ì½”ë“œëª…': 'íì•¤íë©”ë”•ìŠ¤ë°´ë“œ ë¶€ì§í¬+íƒˆì§€ë©´íŒ¨ë“œ 6*8 [1í˜¸]', 'ë‹¨ê°€': '143', 'ê¸‰ë¹„': 'B', 'case_n': 19, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}, {'í•­ëª©': '801', 'ì½”ë“œ': 'SZ634', 'ì²­êµ¬ì½”ë“œ': 'SZ634', 'ì²˜ë°©ì½”ë“œ': 'SZ634A', 'ì½”ë“œëª…': 'PEN -Lumbar(ê²½í”¼ì  ê²½ë§‰ì™¸ê°• ì‹ ê²½ì„±í˜•ìˆ )', 'ë‹¨ê°€': '1,100,000', 'ê¸‰ë¹„': '3', 'case_n': 19, 'ë™ë°˜(ëª¨ë“ ì¼€ì´ìŠ¤)': True}]}}

# -----------------------------
# ê³µí†µ: ë³µë¶™ íŒŒì„œ
# -----------------------------
EXPECTED_COLS = [
    "ì„ íƒ", "ì²˜ë°©ì½”ë“œ", "ì²­êµ¬ì½”ë“œ", "ì²˜ë°©ëª…", "í•­ëª©", "ì¢…ë³„ê°€ì‚°", "ë‹¨ê°€", "ì¢…ë³„ê°€ì‚°ë‹¨ê°€",
    "1íšŒíˆ¬", "Tms/Tot Q", "ì¼ìˆ˜", "ê¸ˆì•¡", "ê¸‰ë¹„", "ê¸‰ë¹„ì§€ì •", "í¬ê´„", "ì™„í™”", "ì›ì™¸", "ë¬´ë£Œ", "ì²˜ë°©ì¼ì", "í•­ëª©ëª…"
]
SECTION_ROW_PATTERN = re.compile(r"^\s*\[\s*.+?\s*\]\s*$")  # [ ì§„ì°°ë£Œ ] ê°™ì€ í–‰

def _clean_lines(raw: str) -> str:
    lines = []
    for ln in raw.replace("\r\n", "\n").replace("\r", "\n").splitlines():
        if not ln.strip():
            continue
        if SECTION_ROW_PATTERN.match(ln.strip()):
            continue
        lines.append(ln.lstrip("\t"))
    return "\n".join(lines)

def _normalize_columns(df: pd.DataFrame) -> pd.DataFrame:
    df.columns = [str(c).replace("\ufeff", "").strip() for c in df.columns]
    rename_map = {
        "ì²˜ë°© ì½”ë“œ": "ì²˜ë°©ì½”ë“œ",
        "ì²­êµ¬ ì½”ë“œ": "ì²­êµ¬ì½”ë“œ",
        "ì²˜ë°©ì½”ë“œ ": "ì²˜ë°©ì½”ë“œ",
        "ì²­êµ¬ì½”ë“œ ": "ì²­êµ¬ì½”ë“œ",
        "ì²˜ ë°© ì½” ë“œ": "ì²˜ë°©ì½”ë“œ",
        "ì²­ êµ¬ ì½” ë“œ": "ì²­êµ¬ì½”ë“œ",
        "ì²˜ë°©ì½”ë“œ(ë‚´ë¶€)": "ì²˜ë°©ì½”ë“œ",
        "ì²­êµ¬ì½”ë“œ(EDI)": "ì²­êµ¬ì½”ë“œ",
    }
    return df.rename(columns=rename_map)

def parse_clipboard_tsv(raw: str) -> pd.DataFrame:
    cleaned = _clean_lines(raw)
    if not cleaned.strip():
        return pd.DataFrame(columns=EXPECTED_COLS)

    df = pd.read_csv(io.StringIO(cleaned), sep="\t", dtype=str, engine="python", keep_default_na=False)
    df = _normalize_columns(df)

    if ("ì²˜ë°©ì½”ë“œ" not in df.columns) and ("ì²­êµ¬ì½”ë“œ" not in df.columns):
        df2 = pd.read_csv(io.StringIO(cleaned), sep="\t", header=None, dtype=str, engine="python", keep_default_na=False)
        df2 = df2.iloc[:, :len(EXPECTED_COLS)]
        df2.columns = EXPECTED_COLS[:df2.shape[1]]
        df = df2
    else:
        for c in EXPECTED_COLS:
            if c not in df.columns:
                df[c] = ""
        df = df[EXPECTED_COLS].copy()

    # ë‚ ì§œ/íŠ¸ë¦¼
    df["ì²˜ë°©ì¼ì"] = df["ì²˜ë°©ì¼ì"].astype(str).str.replace("\ufeff", "", regex=False).str.strip()
    for c in ["í•­ëª©", "ì²˜ë°©ì½”ë“œ", "ì²­êµ¬ì½”ë“œ", "ì²˜ë°©ëª…"]:
        if c in df.columns:
            df[c] = df[c].astype(str).str.replace("\ufeff", "", regex=False).str.strip()

    # ì„¹ì…˜í–‰ ì œê±°
    mask_section = df["ì²˜ë°©ì½”ë“œ"].astype(str).str.strip().str.match(r"^\[.+\]$")
    df = df.loc[~mask_section].copy()

    # ì½”ë“œ ë‘˜ ë‹¤ ë¹„ì–´ìˆëŠ” í•©ê³„í–‰ ì œê±°
    mask_no_codes = (df["ì²˜ë°©ì½”ë“œ"].astype(str).str.strip() == "") & (df["ì²­êµ¬ì½”ë“œ"].astype(str).str.strip() == "")
    df = df.loc[~mask_no_codes].copy()

    return df

# -----------------------------
# RULES -> expected map
# -----------------------------
def build_expected_sets() -> Dict[str, dict]:
    exp: Dict[str, dict] = {}
    for base_code, info in RULES.items():
        rows = info.get("rows", []) or []
        exp_0401 = [r for r in rows if str(r.get("í•­ëª©","")).strip() == "0401"]
        exp_0801 = [r for r in rows if str(r.get("í•­ëª©","")).strip() == "0801"]
        exp[base_code] = {
            "base_col": info.get("base_col", "ì²­êµ¬ì½”ë“œ"),
            "file_name": info.get("file_name", ""),
            "max_case_n": int(info.get("max_case_n", 0) or 0),
            "rows_0401": exp_0401,
            "rows_0801": exp_0801,
        }
    return exp

EXPECTED = build_expected_sets()

def detect_applied_base_codes(df: pd.DataFrame) -> Dict[str, List[str]]:
    """ì²˜ë°©ì¼ìë³„ë¡œ RULES ê¸°ì¤€ì½”ë“œê°€ ì‹¤ì œë¡œ 'ì¡´ì¬'í•œ ëª©ë¡ ë°˜í™˜."""
    applied_by_date: Dict[str, List[str]] = {}
    if df is None or df.empty:
        return applied_by_date

    for col in ["ì²˜ë°©ì¼ì", "í•­ëª©", "ì²­êµ¬ì½”ë“œ", "ì²˜ë°©ì½”ë“œ"]:
        if col not in df.columns:
            df[col] = ""
    d = df.copy()
    d["ì²˜ë°©ì¼ì"] = d["ì²˜ë°©ì¼ì"].astype(str).str.strip()
    d["í•­ëª©"] = d["í•­ëª©"].astype(str).str.strip()

    for rx_date, g in d.groupby("ì²˜ë°©ì¼ì", dropna=False):
        hit_codes = []
        for base_code, rule in EXPECTED.items():
            base_col = rule.get("base_col", "ì²­êµ¬ì½”ë“œ")
            if base_col not in g.columns:
                continue
            base_vals = set(g.loc[g["í•­ëª©"] == "0801", base_col].astype(str).str.strip().tolist())
            base_vals.discard("")
            if base_code in base_vals:
                hit_codes.append(base_code)
        if hit_codes:
            applied_by_date[str(rx_date)] = sorted(set(hit_codes))
    return applied_by_date

def check_missing_and_checks(df: pd.DataFrame, observe_col: str) -> Tuple[pd.DataFrame, pd.DataFrame]:
    """return (checklist_df, missing_df)"""
    base_cols = ["ì²˜ë°©ì¼ì","ê¸°ì¤€ì½”ë“œ","í•­ëª©","ì½”ë“œ","ì²´í¬","case_n","ì½”ë“œëª…","ì²­êµ¬ì½”ë“œ","ì²˜ë°©ì½”ë“œ","ë‹¨ê°€","ê¸‰ë¹„","ê·œì¹™íŒŒì¼"]
    if df is None or df.empty:
        return pd.DataFrame(columns=base_cols), pd.DataFrame(columns=base_cols)

    d = df.copy()
    for c in ["ì²˜ë°©ì¼ì","í•­ëª©",observe_col,"ì²­êµ¬ì½”ë“œ","ì²˜ë°©ì½”ë“œ"]:
        if c not in d.columns:
            d[c] = ""
        d[c] = d[c].astype(str).str.strip()

    applied_by_date = detect_applied_base_codes(d)

    out_rows: List[dict] = []

    for rx_date, g in d.groupby("ì²˜ë°©ì¼ì", dropna=False):
        rx_date = str(rx_date)
        base_codes = applied_by_date.get(rx_date, [])
        if not base_codes:
            continue

        obs_0401 = set(g.loc[g["í•­ëª©"]=="0401", observe_col].astype(str).str.strip().tolist()); obs_0401.discard("")
        obs_0801 = set(g.loc[g["í•­ëª©"]=="0801", observe_col].astype(str).str.strip().tolist()); obs_0801.discard("")

        for base_code in base_codes:
            rule = EXPECTED.get(base_code, {})
            rule_file = rule.get("file_name","")

            for r in rule.get("rows_0401", []):
                code = str(r.get("ì½”ë“œ","")).strip()
                if not code:
                    continue
                ok = (code in obs_0401)
                out_rows.append({
                    "ì²˜ë°©ì¼ì": rx_date,
                    "ê¸°ì¤€ì½”ë“œ": base_code,
                    "í•­ëª©": "0401",
                    "ì½”ë“œ": code,
                    "ì²´í¬": "âœ…" if ok else "âŒ",
                    "case_n": int(r.get("case_n",0) or 0),
                    "ì½”ë“œëª…": str(r.get("ì½”ë“œëª…","")).strip(),
                    "ì²­êµ¬ì½”ë“œ": str(r.get("ì²­êµ¬ì½”ë“œ","")).strip(),
                    "ì²˜ë°©ì½”ë“œ": str(r.get("ì²˜ë°©ì½”ë“œ","")).strip(),
                    "ë‹¨ê°€": str(r.get("ë‹¨ê°€","")).strip(),
                    "ê¸‰ë¹„": str(r.get("ê¸‰ë¹„","")).strip(),
                    "ê·œì¹™íŒŒì¼": rule_file,
                })

            for r in rule.get("rows_0801", []):
                code = str(r.get("ì½”ë“œ","")).strip()
                if not code:
                    continue
                ok = (code in obs_0801)
                out_rows.append({
                    "ì²˜ë°©ì¼ì": rx_date,
                    "ê¸°ì¤€ì½”ë“œ": base_code,
                    "í•­ëª©": "0801",
                    "ì½”ë“œ": code,
                    "ì²´í¬": "âœ…" if ok else "âŒ",
                    "case_n": int(r.get("case_n",0) or 0),
                    "ì½”ë“œëª…": str(r.get("ì½”ë“œëª…","")).strip(),
                    "ì²­êµ¬ì½”ë“œ": str(r.get("ì²­êµ¬ì½”ë“œ","")).strip(),
                    "ì²˜ë°©ì½”ë“œ": str(r.get("ì²˜ë°©ì½”ë“œ","")).strip(),
                    "ë‹¨ê°€": str(r.get("ë‹¨ê°€","")).strip(),
                    "ê¸‰ë¹„": str(r.get("ê¸‰ë¹„","")).strip(),
                    "ê·œì¹™íŒŒì¼": rule_file,
                })

    checklist = pd.DataFrame(out_rows)
    if checklist.empty:
        checklist = pd.DataFrame(columns=base_cols)

    missing = checklist[checklist["ì²´í¬"]=="âŒ"].copy() if not checklist.empty else checklist.copy()
    return checklist, missing

def summarize_result(checklist: pd.DataFrame, missing: pd.DataFrame) -> str:
    if checklist is None or checklist.empty:
        return "ê·œì¹™ì„ ì ìš©í•  ê¸°ì¤€ì½”ë“œ(0801)ê°€ ì´ë²ˆ ë³µë¶™ì—ì„œ ë°œê²¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. (ê¸°ì¤€ì½”ë“œê°€ í¬í•¨ëœ ì²˜ë°©ì¼ì ê¸°ì¤€ìœ¼ë¡œë§Œ ì ê²€í•©ë‹ˆë‹¤.)"

    total_items = len(checklist)
    ok_n = int((checklist["ì²´í¬"]=="âœ…").sum())
    miss_n = int((checklist["ì²´í¬"]=="âŒ").sum())
    base_cnt = checklist[["ì²˜ë°©ì¼ì","ê¸°ì¤€ì½”ë“œ"]].drop_duplicates().shape[0]

    if miss_n == 0:
        return f"âœ… ì ê²€ ì™„ë£Œ: ì ìš© ê·¸ë£¹ {base_cnt}ê±´ / ì²´í¬ {total_items}ê±´ / ëˆ„ë½ 0ê±´"

    top = (missing.groupby(["í•­ëª©","ì½”ë“œ"])
                .size()
                .reset_index(name="ëˆ„ë½íšŸìˆ˜")
                .sort_values(["ëˆ„ë½íšŸìˆ˜","í•­ëª©","ì½”ë“œ"], ascending=[False,True,True])
                .head(5))
    tops = ", ".join([f"{r['í•­ëª©']}-{r['ì½”ë“œ']}({int(r['ëˆ„ë½íšŸìˆ˜'])})" for _,r in top.iterrows()]) if not top.empty else ""
    extra = f" / ëŒ€í‘œ ëˆ„ë½: {tops}" if tops else ""
    return f"âš ï¸ ì ê²€ ì™„ë£Œ: ì ìš© ê·¸ë£¹ {base_cnt}ê±´ / ì²´í¬ {total_items}ê±´ / ëˆ„ë½ {miss_n}ê±´{extra}"

# -----------------------------
# UI
# -----------------------------
st.set_page_config(page_title="ê·œì¹™ ëˆ„ë½ ì ê²€(í•˜ë“œì½”ë”©)", layout="wide")
st.title("ê·œì¹™(í•˜ë“œì½”ë”©) ê¸°ë°˜ ì ê²€: ì²˜ë°© ë³µë¶™ â†’ ì²´í¬í‘œì‹œ/ëˆ„ë½ ìš”ì•½")

with st.sidebar:
    st.subheader("ì„¤ì •")
    observe_col = st.radio("ì²˜ë°©ì—ì„œ ì½”ë“œ ì¡´ì¬ íŒë‹¨ ê¸°ì¤€", ["ì²­êµ¬ì½”ë“œ","ì²˜ë°©ì½”ë“œ"], index=0)
    st.caption("â€» ê¸°ì¤€ì½”ë“œ ì¡´ì¬ íŒì •ì€ ê·œì¹™íŒŒì¼ì˜ base_col + í•­ëª©=0801 ì—ì„œë§Œ í•©ë‹ˆë‹¤.")
    st.divider()
    st.subheader("í•˜ë“œì½”ë”©ëœ ê·œì¹™")
    st.caption(f"ì´ ê¸°ì¤€ì½”ë“œ: {len(EXPECTED):,}ê°œ")

st.subheader("ì²˜ë°© ë³µë¶™")

if "rx_raw" not in st.session_state:
    st.session_state["rx_raw"] = ""

cbtn, _ = st.columns([1, 5])
with cbtn:
    if st.button("ğŸ§¹ ì…ë ¥ì°½ ë¹„ìš°ê¸°", use_container_width=True):
        st.session_state["rx_raw"] = ""
        st.rerun()

raw = st.text_area("í‘œ ê·¸ëŒ€ë¡œ ë¶™ì—¬ë„£ê¸°(íƒ­ êµ¬ë¶„)", height=220, key="rx_raw")

if not raw.strip():
    st.info("ì²˜ë°©ì„ ë³µë¶™í•˜ë©´ ìë™ìœ¼ë¡œ ì ê²€í•©ë‹ˆë‹¤.")
    st.stop()

df_case = parse_clipboard_tsv(raw)
checklist, missing = check_missing_and_checks(df_case, observe_col=observe_col)

applied_pairs = checklist[["ì²˜ë°©ì¼ì","ê¸°ì¤€ì½”ë“œ"]].drop_duplicates() if not checklist.empty else pd.DataFrame(columns=["ì²˜ë°©ì¼ì","ê¸°ì¤€ì½”ë“œ"])
applied_codes = sorted(set(applied_pairs["ê¸°ì¤€ì½”ë“œ"].tolist())) if not applied_pairs.empty else []

with st.expander("ì´ë²ˆ ë³µë¶™ì—ì„œ ì ìš©ëœ ê¸°ì¤€ì½”ë“œ(0801ì—ì„œ ë°œê²¬ëœ ê²ƒë§Œ)", expanded=True):
    rows = []
    for base_code, rule in EXPECTED.items():
        rows.append({
            "ê¸°ì¤€ì½”ë“œ": base_code,
            "ê·œì¹™íŒŒì¼": rule.get("file_name",""),
            "max_case_n": rule.get("max_case_n",0),
            "0401ê°œìˆ˜": len(rule.get("rows_0401",[])),
            "0801ê°œìˆ˜": len(rule.get("rows_0801",[])),
            "ì´ë²ˆë³µë¶™_ì ìš©ì—¬ë¶€": base_code in applied_codes,
        })
    df_show = pd.DataFrame(rows).sort_values(["ì´ë²ˆë³µë¶™_ì ìš©ì—¬ë¶€","ê¸°ì¤€ì½”ë“œ"], ascending=[False, True])

    def _hl(row):
        return ["background-color:#d1fae5"] * len(row) if bool(row.get("ì´ë²ˆë³µë¶™_ì ìš©ì—¬ë¶€")) else [""] * len(row)

    st.dataframe(df_show.style.apply(_hl, axis=1), use_container_width=True, height=260)
    st.caption("ì ìš©ëœ ê¸°ì¤€ì½”ë“œ: " + (", ".join(applied_codes) if applied_codes else "(ì—†ìŒ)"))

st.divider()
st.subheader("ê²°ë¡ ")
st.info(summarize_result(checklist, missing))

VIEW_COLS = ["ì½”ë“œ","ì²´í¬","case_n","ì½”ë“œëª…","ì²­êµ¬ì½”ë“œ","ì²˜ë°©ì½”ë“œ","ë‹¨ê°€","ê¸‰ë¹„"]

def render_side(df: pd.DataFrame, title: str):
    st.markdown(f"### {title}")
    if df is None or df.empty:
        st.info("í‘œì‹œí•  ë‚´ìš© ì—†ìŒ")
        return

    for (rx_date, base_code), g in df.groupby(["ì²˜ë°©ì¼ì","ê¸°ì¤€ì½”ë“œ"], dropna=False):
        miss_n = int((g["ì²´í¬"]=="âŒ").sum())
        ok_n = int((g["ì²´í¬"]=="âœ…").sum())
        st.caption(f"ì²˜ë°©ì¼ì {rx_date} / ê¸°ì¤€ì½”ë“œ {base_code}  â€”  âœ…{ok_n}  âŒ{miss_n}")

        show = g[VIEW_COLS].copy().reset_index(drop=True)

        def _style_row(r):
            if r["ì²´í¬"] == "âŒ":
                return ["background-color:#fee2e2"] * len(r)
            return ["background-color:#d1fae5"] * len(r)

        st.dataframe(show.style.apply(_style_row, axis=1), use_container_width=True)

left, right = st.columns(2)
with left:
    render_side(checklist[checklist["í•­ëª©"]=="0401"].copy(), "0401 ì²´í¬ë¦¬ìŠ¤íŠ¸")
with right:
    render_side(checklist[checklist["í•­ëª©"]=="0801"].copy(), "0801 ì²´í¬ë¦¬ìŠ¤íŠ¸")

st.divider()
st.subheader("ë‹¤ìš´ë¡œë“œ")
x = io.BytesIO()
with pd.ExcelWriter(x, engine="xlsxwriter") as writer:
    checklist.to_excel(writer, index=False, sheet_name="checklist")
    missing.to_excel(writer, index=False, sheet_name="missing")

st.download_button(
    "ğŸ“¥ ì²´í¬/ëˆ„ë½ ê²°ê³¼ ë‹¤ìš´ë¡œë“œ(Excel)",
    data=x.getvalue(),
    file_name=f"rulecheck_result_{datetime.now().strftime('%Y%m%d_%H%M%S')}.xlsx",
    mime="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
    use_container_width=True
)
